"use strict";var main={init:function(){Handlebars.registerHelper("link",(function(e,a){a=Handlebars.escapeExpression(a),e=Handlebars.escapeExpression(e);return new Handlebars.SafeString("<a href='"+a+"' class='button-v1 btn-color-1'><i class='"+e+"'></i></a>")})),Handlebars.registerHelper("inc",(function(e,a){return parseInt(e)+1})),$("[name='httpError']").length&&"true"==$("[name='httpError']").val()&&$.fancybox.open({src:"assets/ajax/card/error.html",type:"ajax",smallBtn:!1})},cardTransactionLocations:function(){var e,a=(r=$("#map")).data("template-url"),t=r.data("json-url"),n={url:"assets/images/layout/pin.png",size:new google.maps.Size(100,102),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(50,48)},o=null,r=null,i=[];function s(){$.ajax({type:"GET",url:t}).done((function(t){e=t,r=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(e.mapCenter.lat,e.mapCenter.lng),zoom:11,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),function(){$.ajax({url:a,type:"GET"}).done((function(a){var t=Handlebars.compile(a)(e);$(".horizontal-list.v1").html(t)})),o&&(o.clearMarkers(),i=[]);for(var t=0;t<e.data.length;++t)s=e.data[t],l=void 0,d=void 0,l=new google.maps.LatLng(s.lat,s.lng),d=new google.maps.Marker({position:l,icon:n,markerLat:s.lat,markerLng:s.lng,selectedId:t,selectedState:!1}),i.push(d);var s,l,d;o=new MarkerClusterer(r,i,{gridSize:40,styles:[{url:"assets/images/layout/map-cluster.png",width:52,height:52,textColor:"#ffffff"}]})}()}))}s(),setInterval((function(){s()}),3e5)},inputAction:function(){if($(".next-input-field").length){var e=$(".next-input-field"),a=e.attr("maxlength");e.keydown((function(e){if(8==e.which&&0==this.value.length)$(this).prev("input").focus();else{if($.inArray(e.which,[8,9,19,20,27,33,34,35,36,37,38,39,40,45,46,144,145])>=0)return!0;if(this.value.length>=a)return $(this).next("input").focus(),!1}})).keyup((function(){this.value.length>=a?$(this).next("input").focus():$(this).parents("form").valid()}))}$(".field-query").length&&$(".field-query").each((function(){$(this).on({keyup:function(){var e=$(this),a=e.data("min-lenght"),t=e.data("url"),n=e.data("method"),o=e.val();o.length>=a&&$.ajax({url:t+o,method:n,dataType:"json"}).done((function(a){!a.status&&a.message?(e.parents(".form-row").addClass("error").find(".text-danger").remove(),e.parent().append("<span class='text-danger'>"+a.message+"</span>")):e.parents(".form-row").removeClass("error").find(".text-danger").remove()}))}})}))},customSelectbox:function(){$(".select-not-find").length&&$(".select-not-find").each((function(e,a){$("select",a).data("select2")||$("select",a).select2({minimumResultsForSearch:-1,dropdownParent:$(a)}).off("select2:open").on("select2:open",(function(e){$(".select2-results .select2-results__options").niceScroll({autohidemode:!1,cursorwidth:4,cursorcolor:"#BCC3CA",cursorborder:2,cursorborderradius:2,horizrailenabled:!0})}))})),$(".select-find").length&&$(".select-find").each((function(e,a){$("select",a).data("select2")||$("select",a).select2({ajax:{url:$(a).find("select").data("json-url"),data:function(e){return{search:e.term}}},dropdownParent:$(a)}).off("select2:open").on("select2:open",(function(e){$(".select2-results .select2-results__options").niceScroll({autohidemode:!1,cursorwidth:4,cursorcolor:"#BCC3CA",cursorborder:2,cursorborderradius:2,horizrailenabled:!0})}))}))},addWitness:function(){if($(".addWitness").length){var e=1;$(".addWitness").on({click:function(){var a="<div class='form-row'><a href='javascript:;' class='button button-v4 color-1 line-height-sml removeWitness'><i class='icon-cancel'></i></a><span class='label witness-label'>Witness Statments</span><div class='input-group-content'><label><input type='text' name='witnessName"+e+"' placeholder='Name'></label><label><input type='text' name='witnessSurname"+e+"' placeholder='Surname'></label></div><div class='form-row'><label><span class='label'></span><textarea name='witnessStatement"+e+"' placeholder='Statement'></textarea></label></div></div>";$(".witness-container").append(a),e++,$(".removeWitness").off("click").on({click:function(){$(this).parents(".form-row").remove()}})}})}},datePicker:function(){if($(".datepicker").length&&$(".datepicker").each((function(){$(this).datepicker()})),$("#calendar").length){var e=$("#calendar").data("next-url");$("#calendar").datepicker({onSelect:function(a,t){window.location.href=e+"?calendarDate="+a}})}},timePicker:function(){$(".timepicker").length&&$(".timepicker").timepicker({timeFormat:"h:mm p",dynamic:!1,dropdown:!0,scrollbar:!0,zindex:99999})},dropzone:function(){$(".photo-upload").length&&$(".photo-upload").each((function(){var e=$(this).find(".photo-upload-inner"),a=e.data("upload-url"),t=e.data("delete-url"),n=e.data("max-files")?e.data("max-files"):null;e.hasClass("dz-started")||e.dropzone({url:a,maxFiles:n,addRemoveLinks:!0,dictRemoveFile:"",thumbnailMethod:"contain",dictDefaultMessage:null,removedfile:function(e){var a,n=e.name;return $.ajax({url:t,type:"POST",data:"id="+n,dataType:"html"}),null!=(a=e.previewElement)?a.parentNode.removeChild(e.previewElement):void 0},init:function(){var a=this;if(a.on("addedfile",(function(e){null!=a.files[n]&&a.removeFile(a.files[0])})),e.parents(".photo-upload").hasClass("upload-view")){var t=e.data("upload-ajax-url");$.ajax({url:t}).done((function(e){for(var t=0;t<e.data.length;t++)a.files.push(e.data[t]),a.emit("addedfile",e.data[t]),a.emit("thumbnail",e.data[t],e.data[t].url),a.emit("complete",e.data[t]),e.data[t].previewElement.classList.add("dz-success"),e.data[t].previewElement.classList.add("dz-complete")}))}}})}))},pagination:function(){$(".pagination").each((function(e,a){$("select",a).on({change:function(){var e=$("option:selected",this).prev("option"),t=$("option:selected",this).next("option");e.length?$(".prev",a).removeClass("disabled"):$(".prev",a).addClass("disabled"),t.length?$(".next",a).removeClass("disabled"):$(".next",a).addClass("disabled")}}).trigger("change"),$(".prev",a).on({click:function(e){var t=$("select",a),n=$("option:selected",t).prev("option");n.length&&(n.prop("selected",!0),t.trigger("change")),e.preventDefault()}}),$(".next",a).on({click:function(e){var t=$("select",a),n=$("option:selected",t).next("option");n.length&&(n.prop("selected",!0),t.trigger("change")),e.preventDefault()}})}))},filterControl:function(){var e=$.Deferred();return $(".site-data-container").length?$(".site-data-container").each((function(){var a,t,n=$(this),o=$(".site-data-filters",n),r=$(".site-data-content",n),i=$(".site-data-pagination",n),s=n.data("template-url"),l=n.data("json-url");function d(t){n.addClass("loading"),t||$("select",i).val("1").data("value","1");var o=$(":input",n).serialize();$.ajax({type:"GET",url:l,dataType:"json",data:o,success:function(o){if(o.data.length||o.data.tbody.length){var s=Handlebars.compile(a)(o);if($(".error-text",n).text("").hide(),$(".complaints-detail-content").length&&$(".complaints-detail-content").html(""),r.html(s),n.removeClass("loading"),r.show(),o.pages>1?i.show():i.hide(),!t){$("select",i).html("");for(var l=1;l<=o.pages;l++)$("select",i).append('<option value="'+l+'">'+l+"</option>")}e.resolve(),main.fancybox()}else n.removeClass("loading"),i.hide(),r.html("").hide(),$(".error-text",n).text(o.message).show(),e.resolve()}})}$.ajax({type:"GET",url:s,async:!1,success:function(e){a=e}});var c=$(":input",o).serialize();o.on({submit:function(e){t=$(":input",o).serialize(),c!=t&&(c=t,d()),e.preventDefault()}}),$(".change-on-submit").length&&$(".change-on-submit").on({change:function(){d()}}),$("select",i).on({change:function(){$(this).val()!=$(this).data("value")&&($(this).data("value",$(this).val()),d(!0))}}),d()})):e.resolve(),e},carousel:function(){$(".card-carousel").length&&$(".card-carousel").owlCarousel({rtl:!0,margin:15,nav:!0,navText:["<i class='icon-right-open'></i>","<i class='icon-left-open'></i>"],dots:!1})},fancybox:function(){$.fancybox.defaults.touch=!1,$("[data-fancybox-card]").length&&$("[data-fancybox-card]").fancybox({smallBtn:!1,toolbar:!1}),$("[data-fancybox-search]").length&&$("[data-fancybox-search]").fancybox({smallBtn:!1,toolbar:!1,beforeLoad:function(e,a,t){var n=t.opts.$orig;n&&n.parents(".search-box-v2").addClass("fancy-click-element")}}),$(document).on("afterLoad.fb",(function(e,a){main.carousel(),main.timePicker(),main.dropzone(),main.validationsCommon()}))},validationMethods:function(){$(".no-paste").bind("cut copy paste",(function(e){e.preventDefault()})),$(".only-number").on({keydown:function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110,190])||65==e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}}),$.validator.addMethod("lettersonly",(function(e,a){return this.optional(a)||/^[a-z ğüöçıİş]+$/i.test(e)}))},validationsCommon:function(){var e,a;$("form").length&&$("form").each((function(t,n){e=$(".form-general-success",n),a=$(".form-general-error",n)}));var t={ignore:".skip-validation, .dynamic-skip-validation",errorElement:"span",errorPlacement:function(e,a){e.addClass("text-danger").appendTo(a.parents(".form-row"))},highlight:function(e,a,t){$(e).parents(".form-row").removeClass(t).addClass(a)},unhighlight:function(e,a,t){$(e).parents(".form-row").removeClass(a).addClass(t)},submitHandler:function(t){if(e.hide(),a.hide(),($(t).hasClass("login-user-name")||$(t).hasClass("login-user-code")||$(t).hasClass("login-pass-code"))&&$(t).find(".form-container").addClass("loading"),$(t).data("url")){var n=$(t).data("url"),o=$(t).attr("method")||"GET",r=$(t).attr("enctype"),i=$(t).serialize(),s="";($(t).hasClass("login-user-code")||$(t).hasClass("login-pass-code"))&&($(t).find("input[type='text']").each((function(){var e=$(this).val();s+=e})),i="code="+s);var l={url:n,type:o,dataType:"json",data:i,cache:!1,timeout:9e5};"multipart/form-data"===r&&$.extend(l,{processData:!1,contentType:!1,timeout:6e4,data:new FormData(t)}),$.ajax(l).done((function(e){e.status?e.nextUrl&&(window.location.href=e.nextUrl):(e.message&&($(t).find(".form-general-error .alert-title").text(e.message),$(t).find(".form-general-error").show()),($(t).hasClass("login-user-name")||$(t).hasClass("login-user-code")||$(t).hasClass("login-pass-code"))&&$(t).find(".form-container").removeClass("loading"))}))}else t.submit()}},n=$(".previousCase");if(n.length){var o=$.extend({},t);n.validate(o)}var r=$(".login-user-name");if(r.length){o=$.extend({},t,{rules:{username:{required:!0}},messages:{username:{required:"Bu alan boş geçilemez."}}});r.validate(o)}var i=$(".login-user-code");if(i.length){o=$.extend({},t,{groups:{inputGroup:"userCode1 userCode2 userCode3 userCode4 userCode5"},rules:{userCode1:{required:!0},userCode2:{required:!0},userCode3:{required:!0},userCode4:{required:!0},userCode5:{required:!0}},messages:{userCode1:{required:"Bu alan boş geçilemez."},userCode2:{required:"Bu alan boş geçilemez."},userCode3:{required:"Bu alan boş geçilemez."},userCode4:{required:"Bu alan boş geçilemez."},userCode5:{required:"Bu alan boş geçilemez."}}});i.validate(o)}var s=$(".login-pass-code");if(s.length){o=$.extend({},t,{groups:{inputGroup:"passCode1 passCode2 passCode3"},rules:{passCode1:{required:!0},passCode2:{required:!0},passCode3:{required:!0}},messages:{passCode1:{required:"Bu alan boş geçilemez."},passCode2:{required:"Bu alan boş geçilemez."},passCode3:{required:"Bu alan boş geçilemez."}}});s.validate(o)}},alertify:function(e,a,t){var n="<div class='alertify "+e+"'><p class='message'>"+a+"</p></div>";$("body").append(n),$(".alertify").fadeIn(300),setInterval((function(){$(".alertify").fadeOut(300,(function(){$(this).remove()}))}),t)}};function initMap(){$("#map").length&&main.cardTransactionLocations()}$((function(){main.init(),main.inputAction(),main.customSelectbox(),main.addWitness(),main.datePicker(),main.timePicker(),main.dropzone(),main.carousel(),main.fancybox(),main.pagination(),main.filterControl(),main.validationMethods(),main.validationsCommon()}));